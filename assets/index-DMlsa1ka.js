(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();class it{entityCount=0;entities=[];componentMap=new Map;createEntity(){const e=this.entityCount;return this.entities.push(e),this.componentMap.set(e,new Map),this.entityCount++,e}addComponent(e,o,n){if(!this.hasEntity(e))throw new Error(`Entity ${e} does not exist!`);const s=this.componentMap.get(e);s?.has(o)||s?.set(o,n)}removeComponent(e,o){if(!this.hasEntity(e))throw new Error(`Entity ${e} does not exist!`);const n=this.componentMap.get(e);n?.has(o)&&n.delete(o)}getComponent(e,o,n){if(!this.hasEntity(e))throw new Error(`Entity ${e} does not exist!`);const a=this.componentMap.get(e)?.get(o);if(n&&!a)throw new Error(`'${o.name}' COMPONENT NOT FOUND ON ENTITY: `+e);return a}getAllComponents(e){if(!this.hasEntity(e))throw new Error(`Entity ${e} does not exist!`);const o=this.componentMap.get(e);return o?Array.from(o.values()):[]}hasComponent(e,o){if(!this.hasEntity(e))throw new Error(`Entity ${e} does not exist!`);return this.componentMap.get(e)?.has(o)??!1}removeEntity(e){if(!this.hasEntity(e))throw new Error(`Entity ${e} does not exist!`);this.entities=this.entities.filter(o=>o!==e),this.componentMap.delete(e)}query(e,o,n){const s=[...this.entities];for(const a of s){if(!this.hasEntity(a))continue;const i={},c=[];for(const l in o){const h=o[l],u=this.getComponent(a,h);u&&(i[l]=u),c.push(!!u)}let r=!1;if(e==="All")r=c.every(Boolean);else if(e==="Any")r=c.some(Boolean);else if(e==="None")r=c.every(l=>!l);else throw new Error(`Unknown filter type: ${e}`);r&&n(a,i)}}getAllEntities(){return this.entities}hasEntity(e){return!!this.entities.includes(e)}}var rt=class{resources;constructor(t={}){this.resources=t}async fetchData(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP Error: ${e.status} ${e.statusText}`);return await e.json()}catch(e){throw console.error(`❌ Failed to fetch JSON at: ${t}
`,e),new Error(`FetchDataError
URL: ${t}
Reason: ${e.message}`)}}loadImages(){const t=this.resources.images_JSON_path??"";return t===""?(console.warn("NO IMAGES PASSED TO LOAD"),Promise.resolve({})):new Promise((e,o)=>{this.fetchData(t).then(n=>{const s=Object.keys(n),a=s.length;let i=0,c={};s.forEach(r=>{const l=new Image;l.src=n[r],c[r]=l,l.onload=()=>{i++,i===a&&e(c)},l.onerror=()=>{console.error(`❌ Failed to load image: ${n[r]}`),o(new Error(`ImageLoadError
File: ${n[r]}`))}})}).catch(n=>{console.error("❌ Failed during image JSON loading:",n),o(new Error(`ImageLoadingError
${n.message}`))})})}loadAudio(){const t=this.resources.audio_JSON_path??"";return t===""?(console.warn("⚠️ No audio JSON path provided."),Promise.resolve({})):new Promise((e,o)=>{this.fetchData(t).then(n=>{const s=Object.keys(n);let a=0;const i={};s.forEach(c=>{const r=new Audio;r.src=n[c],r.preload="auto",i[c]=r,r.addEventListener("canplaythrough",()=>{a++,a===s.length&&e(i)}),r.onerror=()=>{console.error(`❌ Failed to load audio: ${n[c]}`),o(new Error(`AudioLoadError
File: ${n[c]}`))}})}).catch(n=>{console.error("❌ Failed during audio JSON loading:",n),o(new Error(`AudioLoadingError
${n.message}`))})})}async loadAll(){const t=this.loadImages(),e=this.loadAudio(),o=[],n=[];if(this.resources.jsons)for(const[s,a]of Object.entries(this.resources.jsons))n.push(s),o.push(this.fetchData(a));try{const[s,a,...i]=await Promise.all([t,e,...o]),c={};return n.forEach((r,l)=>{c[r]=i[l]}),{imagesData:s,audioData:a,customJsonData:c}}catch(s){throw console.error("❌ Failed to load all resources:",s),new Error(`LoadAllResourcesError
${s.message}`)}}},ct=class{value=0;constructor(t=0){this.value=t??0}},lt=class{value={x:1,y:1};constructor(t={}){this.value=t.value??{x:1,y:1}}},p=class{globalPosition;rotation;scale;constructor(t={}){this.globalPosition={position:t.globalPosition??{x:0,y:0}},this.rotation=new ct(t.rotation?.value),this.scale=new lt({value:t.scale?.value})}},T=class{image;width;height;alpha;rotation;layer;active;blocksInput=!0;scale={x:1,y:1};constructor(t){this.image=t.image,this.width=t.width,this.height=t.height,this.alpha=t.alpha??1,this.rotation=t.rotation??0,this.layer=t.layer??0,this.active=t.active??!0,this.blocksInput=t.blocksInput??!0,this.scale=t.scale??{x:1,y:1}}},W=class{value=!0;constructor(t={}){this.value=t.value??!0}},G=class{value=null;constructor(t={}){this.value=t.value??null}},M=class{value=[]},S=class{name="";onLoad;onUnload;constructor(t){this.name=t.name,this.onLoad=t.onLoad??(()=>{}),this.onUnload=t.onUnload??(()=>{})}},v=class{shape;color="green";outlineEnabled=!1;outlineWidth=3;outlineColor="black";alpha=1;active=!0;layer=0;blocksInput=!0;constructor(t){this.shape=t.shape,this.color=t.color??"green",this.outlineEnabled=t.outlineEnabled??!1,this.outlineWidth=t.outlineWidth??3,this.outlineColor=t.color??"black",this.alpha=t.alpha??1,this.active=t.active??!0,this.layer=t.layer??0,this.blocksInput=t.blocksInput??!0}},J=class{width;height;centered=!0;rotation=0;rounded=!1;roundedRadius=5;constructor(t){this.width=t.width??40,this.height=t.height??40,this.centered=t.centered??!0,this.rotation=t.rotation??0,this.rounded=t.rounded??!1,this.roundedRadius=t.roundRadius??5}},k=class{radius;constructor(t){this.radius=t.radius??40}},B=class{p1;p2;p3;centered=!0;rotation=0;constructor(t){this.p1=t.p1??{x:30,y:0},this.p2=t.p2??{x:0,y:59},this.p3=t.p3??{x:30,y:59},this.centered=t.centered??!0,this.rotation=t.rotation??0}},I=class{content="text";size=16;color="white";outlineEnabled=!1;outlineWidth=2;outlineColor="black";alpha=1;active=!0;layer=0;rotation=0;style="sans-serif";maxWidth=200;constructor(t){this.content=t.content??"text",this.size=t.size??16,this.color=t.color??"white",this.outlineEnabled=t.outlineEnabled??!1,this.outlineWidth=t.outlineWidth??2,this.outlineColor=t.outlineColor??"black",this.alpha=t.alpha??1,this.active=t.active??!0,this.layer=t.layer??0,this.rotation=t.rotation??0,this.style=t.style??"sans-serif",this.maxWidth=t.maxWidth??200}},F=class{pressArea={x:100,y:100};onJustPressed=()=>{};onPress=()=>{};onJustReleased=()=>{};onJustHovered=()=>{};onHovered=()=>{};onHoveredReleased=()=>{};showPressArea=!1;pressAreaShowColor="green";layer=0;active=!0;changeCursorToPointer=!0;isHovered=!1;constructor(t){this.pressArea=t.pressArea??{x:100,y:100},this.onJustPressed=t.onJustPressed??(()=>{}),this.onPress=t.onPress??(()=>{}),this.onJustReleased=t.onReleased??(()=>{}),this.onJustHovered=t.onJustHovered??(()=>{}),this.onHovered=t.onHovered??(()=>{}),this.onHoveredReleased=t.onHoveredReleased??(()=>{}),this.showPressArea=t.showPressArea??!1,this.pressAreaShowColor=t.pressAreaShowColor??"green",this.layer=t.layer??0,this.active=t.active??!0,this.changeCursorToPointer=t.changeCursorToPointer??!0}},N=class{alignmentHorizontal="none";alignmentVertical="none";offset={x:0,y:0};constructor(t){this.alignmentHorizontal=t.alignmentHorizontal??"none",this.alignmentVertical=t.alignmentVertical??"none",this.offset=t.offset??{x:0,y:0}}},z=class{maxNumber;img;minScaleRange;maxScaleRange;minSpeedRange;maxSpeedRange;minLifeTimeRange;maxLifeTimeRange;minAlphaRange;maxAlphaRange;minRotationRange;maxRotationRange;alphaReductionRate;duration;counter;constructor(t){this.maxNumber=t.maxNumber??16,this.img=t.img,this.minScaleRange=t.minScaleRange??{x:1,y:1},this.maxScaleRange=t.maxScaleRange??{x:2,y:2},this.minSpeedRange=t.minSpeedRange??30,this.maxSpeedRange=t.maxSpeedRange??100,this.minLifeTimeRange=t.minLifeTimeRange??1,this.maxLifeTimeRange=t.maxLifeTimeRange??2,this.minAlphaRange=t.minAlphaRange??.5,this.maxAlphaRange=t.maxAlphaRange??1,this.minRotationRange=t.minRotationRange??0,this.maxRotationRange=t.maxRotationRange??360,this.alphaReductionRate=t.alphaReductionRate??.4,this.duration=t.duration??1,this.counter=this.duration}},_=class{lifeTime;velocity;alphaReductionRate;constructor(t){this.lifeTime=t.lifeTime,this.velocity=t.velocity,this.alphaReductionRate=t.alphaReductionRate}},X=class{engine;constructor(t){this.engine=t}drawSprite(t,e){const o=this.engine.getCtx(),n=Math.PI*e.rotation/180,s=Math.PI*t.rotation.value/180,a=n+s,i=t.globalPosition.position,c=e.scale.x*e.width,r=e.scale.y*e.height;o.save(),o.translate(i.x,i.y),o.scale(t.scale.value.x,t.scale.value.y),o.globalAlpha=e.alpha,o.rotate(a),o.drawImage(e.image,-c/2,-r/2,c,r),o.restore()}isEntityBlockingInput(t,e,o){const n=this.engine.getEntityManager();let s=!1;return n.query("All",{transform:p,sprite:T},(a,{transform:i,sprite:c})=>{if(!this.engine.isEntityActive(a)||!c.active||!c.blocksInput||c.layer<=o)return;const r=i.globalPosition.position,l=c.width*i.scale.value.x,h=c.height*i.scale.value.y,u=r.x-l/2,g=r.y-h/2;t>=u&&t<=u+l&&e>=g&&e<=g+h&&(s=!0)}),n.query("All",{transform:p,shape:v},(a,{transform:i,shape:c})=>{if(!this.engine.isEntityActive(a)||!c.active||!c.blocksInput||c.layer<=o)return;const r=c.shape;if(r instanceof J){const l=r.width*i.scale.value.x,h=r.height*i.scale.value.y;let u={...i.globalPosition.position};r.centered&&(u.x-=l/2,u.y-=h/2),t>=u.x&&t<=u.x+l&&e>=u.y&&e<=u.y+h&&(s=!0)}else if(r instanceof k){const l=r.radius,h=i.globalPosition.position,u=i.scale.value,g=l*u.x,m=l*u.y,d=t-h.x,x=e-h.y;d*d/(g*g)+x*x/(m*m)<=1&&(s=!0)}else if(r instanceof B){let l=function(f){let D=f.x*g.x,w=f.y*g.y;const P=Math.cos(m),U=Math.sin(m),V=D*P-w*U,j=D*U+w*P;return{x:u.x+V,y:u.y+j}},h=function(f,D,w,P){const U=(D.x-f.x)*(w.y-f.y)-(w.x-f.x)*(D.y-f.y),V=(w.x-f.x)*(P.y-f.y)-(P.x-f.x)*(w.y-f.y),j=(P.x-f.x)*(D.y-f.y)-(D.x-f.x)*(P.y-f.y),st=U<0||V<0||j<0,at=U>0||V>0||j>0;return!(st&&at)};const u=i.globalPosition.position,g=i.scale.value,m=Math.PI*(r.rotation+i.rotation.value)/180;let d,x,E;if(r.centered){const f={x:(r.p1.x+r.p2.x+r.p3.x)/3,y:(r.p1.y+r.p2.y+r.p3.y)/3};d={x:r.p1.x-f.x,y:r.p1.y-f.y},x={x:r.p2.x-f.x,y:r.p2.y-f.y},E={x:r.p3.x-f.x,y:r.p3.y-f.y}}else d={x:0,y:0},x={x:r.p2.x-r.p1.x,y:r.p2.y-r.p1.y},E={x:r.p3.x-r.p1.x,y:r.p3.y-r.p1.y};const R=l(d),O=l(x),b=l(E);h({x:t,y:e},R,O,b)&&(s=!0)}}),s}getEntitySize(t){const e=this.engine.getEntityManager();if(e.getComponent(t,S))return{x:this.engine.getCanvasBounds().x,y:this.engine.getCanvasBounds().y};const n=e.getComponent(t,T);if(n)return{x:n.width,y:n.height};const s=e.getComponent(t,v);if(s){const c=s.shape;if(c instanceof J)return{x:c.width,y:c.height};if(c instanceof k)return{x:c.radius*2,y:c.radius*2};if(c instanceof B){const r=Math.min(c.p1.x,c.p2.x,c.p3.x),l=Math.max(c.p1.x,c.p2.x,c.p3.x),h=Math.min(c.p1.y,c.p2.y,c.p3.y),u=Math.max(c.p1.y,c.p2.y,c.p3.y);return{x:l-r,y:u-h}}}const a=e.getComponent(t,I);if(a){const c=this.engine.getCtx();c.font=`${a.size}px ${a.style}`;const r=c.measureText(a.content);return{x:Math.min(r.width,a.maxWidth),y:a.size}}const i=e.getComponent(t,F);return i?{x:i.pressArea.x,y:i.pressArea.x}:null}calculateAlignedPosition(t,e,o,n,s,a){let i=t.x,c=t.y;switch(s&&(i-=e.x/2,c-=e.y/2),n.alignmentHorizontal){case"center":i+=e.x/2-o.x/2;break;case"right":i+=e.x-o.x;break}switch(n.alignmentVertical){case"middle":c+=e.y/2-o.y/2;break;case"bottom":c+=e.y-o.y;break}return i+=n.offset.x,c+=n.offset.y,a&&(i+=o.x/2,c+=o.y/2),{x:i,y:c}}isEntityCentered(t){const e=this.engine.getEntityManager();if(e.getComponent(t,S))return!1;const n=e.getComponent(t,v);if(n){const a=n.shape;if(a instanceof J||a instanceof B)return a.centered;if(a instanceof k)return!0}return e.getComponent(t,T),!0}removeChildrenReclusively(t){const e=this.engine.getEntityManager(),o=e.getComponent(t,M);if(o)for(const n of o.value)e.hasEntity(n)&&this.engine.removeEntityWithCleanup(n)}unlinkFromParent(t){const e=this.engine.getEntityManager(),o=e.getComponent(t,G);if(o&&o?.value!==null&&e.hasEntity(o.value)){const n=e.getComponent(o.value,M);n&&(n.value=n.value.filter(s=>s!==t))}}};function ut(t){const e=t.getEntityManager(),o=[];for(const n of e.getAllEntities()){if(!t.isEntityActive(n)||!e.getComponent(n,p))continue;const a=e.getComponent(n,T);if(a){if(!a.active)continue;o.push({layer:a.layer??0,drawFn:()=>ht(t,n)})}const i=e.getComponent(n,v);if(i){if(!i.active)continue;const l=i.layer;let h=null;i.shape instanceof J?h=()=>dt(t,n):i.shape instanceof k?h=()=>mt(t,n):i.shape instanceof B&&(h=()=>gt(t,n)),h&&o.push({layer:l,drawFn:h})}const c=e.getComponent(n,I);if(c){if(!c.active)return;o.push({layer:c.layer,drawFn:()=>pt(t,n)})}const r=e.getComponent(n,F);r&&r.showPressArea&&o.push({layer:r.layer,drawFn:()=>yt(t,n)})}o.sort((n,s)=>n.layer-s.layer);for(const n of o)n.drawFn()}function ht(t,e){const o=new X(t),n=t.getEntityManager(),s=n.getComponent(e,p,!0),a=n.getComponent(e,T,!0);o.drawSprite(s,a)}function dt(t,e){const o=t.getEntityManager(),n=t.getCtx(),s=o.getComponent(e,p,!0),a=o.getComponent(e,v,!0),i=a.shape;if(i instanceof J){const c=s.globalPosition.position.x,r=s.globalPosition.position.y,l=i.width,h=i.height,u=Math.PI*i.rotation/180,g=Math.PI*s.rotation.value/180,m=u+g,d={x:i.centered?-l/2:0,y:i.centered?-h/2:0};n.save(),n.fillStyle=a.color,n.globalAlpha=a.alpha,n.beginPath(),n.translate(c,r),n.rotate(m),n.scale(s.scale.value.x,s.scale.value.y),i.rounded?n.roundRect(d.x,d.y,l,h,i.roundedRadius):n.rect(d.x,d.y,l,h),n.fill(),n.closePath(),a.outlineEnabled&&(n.strokeStyle=a.outlineColor,n.lineWidth=a.outlineWidth,n.beginPath(),i.rounded?n.roundRect(d.x,d.y,l,h,i.roundedRadius):n.rect(d.x,d.y,l,h),n.stroke(),n.closePath()),n.restore()}else console.warn("SHAPE IS NOT A RECTANGLE BUT IS IN RECTANGLE RENDERING SYSTEM! "+e)}function mt(t,e){const o=t.getEntityManager(),n=t.getCtx(),s=o.getComponent(e,p,!0),a=o.getComponent(e,v,!0);if(a.shape instanceof k){const i=s.globalPosition.position.x,c=s.globalPosition.position.y,r=a.shape.radius;n.save(),n.fillStyle=a.color,n.globalAlpha=a.alpha,n.beginPath(),n.translate(i,c),n.scale(s.scale.value.x,s.scale.value.y),n.arc(0,0,r,0,Math.PI*2),n.fill(),n.closePath(),a.outlineEnabled&&(n.strokeStyle=a.outlineColor,n.lineWidth=a.outlineWidth,n.beginPath(),n.arc(0,0,r,0,Math.PI*2),n.stroke(),n.closePath()),n.restore()}else console.warn("SHAPE IS NOT A CIRCLE BUT IS IN RECTANGLE RENDERING SYSTEM! "+e)}function gt(t,e){const o=t.getEntityManager(),n=t.getCtx(),s=o.getComponent(e,p,!0),a=o.getComponent(e,v,!0),i=a.shape;if(!(i instanceof B)){console.warn("SHAPE IS NOT A TRIANGLE BUT IS IN TRIANGLE RENDERING SYSTEM! "+e);return}const c=s.globalPosition.position,r=Math.PI*i.rotation/180,l=Math.PI*s.rotation.value/180,h=r+l;let u,g,m;if(i.centered){const d={x:(i.p1.x+i.p2.x+i.p3.x)/3,y:(i.p1.y+i.p2.y+i.p3.y)/3};u={x:i.p1.x-d.x,y:i.p1.y-d.y},g={x:i.p2.x-d.x,y:i.p2.y-d.y},m={x:i.p3.x-d.x,y:i.p3.y-d.y}}else u={x:0,y:0},g={x:i.p2.x-i.p1.x,y:i.p2.y-i.p1.y},m={x:i.p3.x-i.p1.x,y:i.p3.y-i.p1.y};n.save(),n.fillStyle=a.color,n.globalAlpha=a.alpha,n.translate(c.x,c.y),n.rotate(h),n.scale(s.scale.value.x,s.scale.value.y),n.beginPath(),n.moveTo(u.x,u.y),n.lineTo(g.x,g.y),n.lineTo(m.x,m.y),n.closePath(),n.fill(),a.outlineEnabled&&(n.strokeStyle=a.outlineColor,n.lineWidth=a.outlineWidth,n.beginPath(),n.moveTo(u.x,u.y),n.lineTo(g.x,g.y),n.lineTo(m.x,m.y),n.closePath(),n.stroke()),n.restore()}function pt(t,e){const o=t.getEntityManager(),n=t.getCtx(),s=o.getComponent(e,p,!0),a=o.getComponent(e,I,!0),i=s.globalPosition.position,c=Math.PI*a.rotation/180,r=Math.PI*s.rotation.value/180,l=c+r;n.save(),n.translate(i.x,i.y),n.rotate(l),n.scale(s.scale.value.x,s.scale.value.y),n.beginPath(),n.textAlign="center",n.textBaseline="middle",n.fillStyle=a.color,n.font=`${a.size}px ${a.style}`,n.fillText(a.content,0,0,a.maxWidth),n.closePath(),a.outlineEnabled&&(n.beginPath(),n.strokeStyle=a.outlineColor,n.lineWidth=a.outlineWidth,n.font=`${a.size}px ${a.style}`,n.strokeText(a.content,0,0,50),n.closePath()),n.restore()}function yt(t,e){const o=t.getEntityManager(),n=t.getCtx(),s=o.getComponent(e,p,!0),a=o.getComponent(e,F,!0),i=s?.globalPosition.position,c=a.pressArea.x,r=a.pressArea.y,l=Math.PI*s.rotation.value/180;a.showPressArea&&(n.save(),n.translate(i.x,i.y),n.rotate(l),n.scale(s.scale.value.x,s.scale.value.y),n.beginPath(),n.globalAlpha=.25,n.fillStyle=a.pressAreaShowColor,n.rect(-c/2,-r/2,a.pressArea.x,a.pressArea.y),n.fill(),n.closePath(),n.restore())}var ft=class{engine;position={x:0,y:0};justPressed=!1;pressed=!1;justReleased=!1;constructor(t){this.engine=t,this.start()}start(){this.engine.addUpdateFunction(this.update.bind(this)),this.addListeners()}update(){}updatePos(t,e){const n=this.engine.getCanvas().getBoundingClientRect();this.position.x=t-n.left,this.position.y=e-n.top}addListeners(){const t=["mousedown","touchstart"],e=["mousemove","touchmove"],o=["mouseup","touchend"];t.forEach(n=>{this.engine.getCanvas().addEventListener(n,s=>{s instanceof MouseEvent?this.updatePos(s.clientX,s.clientY):s instanceof TouchEvent&&this.updatePos(s.touches[0].clientX,s.touches[0].clientY),this.justPressed=!0,this.pressed=!0},{passive:!0})}),e.forEach(n=>{this.engine.getCanvas().addEventListener(n,s=>{s instanceof MouseEvent?this.updatePos(s.clientX,s.clientY):s instanceof TouchEvent&&this.updatePos(s.touches[0].clientX,s.touches[0].clientY)},{passive:!0})}),o.forEach(n=>{this.engine.getCanvas().addEventListener(n,()=>{this.justReleased=!0,this.pressed=!1})})}resetStates(){this.justPressed=!1,this.justReleased=!1}getPosition(){return this.position}getJustPressed(){return this.justPressed}getPressed(){return this.pressed}getJustReleased(){return this.justReleased}},xt=class{engine;constructor(t){this.engine=t}isOver(t,e,o,n){const a=this.engine.getInput().getPosition();return a.x>=t&&a.x<=t+o&&a.y>=e&&a.y<=e+n}};function Et(t){const e=new X(t),o=new xt(t),n=t.getEntityManager(),s=t.getInput();t.getCtx();let a=!1;n.query("All",{transform:p,button:F},(i,{transform:c,button:r})=>{if(!t.isEntityActive(i)||!r.active){r.isHovered&&(r.isHovered=!1,r.onHoveredReleased());return}const l=c.globalPosition.position,h=r.pressArea.x,u=r.pressArea.y,g=h*c.scale.value.x,m=u*c.scale.value.y,d=l.x-h/2,x=l.y-u/2;if(o.isOver(d,x,g,m)){if(e.isEntityBlockingInput(s.getPosition().x,s.getPosition().y,r.layer))return;a=!0,r.isHovered||(r.isHovered=!0,r.onJustHovered()),r.onHovered(),s.getJustPressed()&&r.onJustPressed(),s.getPressed()&&r.onPress(),s.getJustReleased()&&r.onJustReleased()}else r.isHovered&&(r.isHovered=!1,r.onHoveredReleased());if(r.changeCursorToPointer){const R=t.getCanvas();a?R.style.cursor="pointer":R.style.cursor="default"}})}function vt(t){const e=new X(t),o=t.getEntityManager();o.query("All",{transform:p,alignment:N,parent:G},(n,{transform:s,alignment:a,parent:i})=>{const c=i.value;if(c===null)return;const r=o.getComponent(c,p,!0),l=e.getEntitySize(c),h=e.getEntitySize(n);if(!l||!h)return;const u=e.isEntityCentered(c),g=e.isEntityCentered(n),m=e.calculateAlignedPosition(r.globalPosition.position,l,h,a,u,g);s.globalPosition.position=m})}function Ct(t){const e=t.getEntityManager(),o=t.getDeltaTime();e.query("All",{particleContainer:z},(n,{particleContainer:s})=>{s.counter-=o,s.counter<=0&&t.removeEntityWithCleanup(n)})}function Rt(t){const e=t.getEntityManager(),o=t.getDeltaTime();e.query("All",{transform:p,sprite:T,particle:_},(n,{transform:s,sprite:a,particle:i})=>{if(!t.isEntityActive(n))return;const c=s.globalPosition.position;c.x+=i.velocity.x*o,c.y+=i.velocity.y*o,i.lifeTime-=o,a.alpha=Math.max(i.lifeTime/i.alphaReductionRate,0),i.lifeTime<=0})}var wt=class{constructor(){}saveData(t,e){localStorage.setItem(t,JSON.stringify(e))}getData(t,e){const o=localStorage.getItem(t);if(o===null)return this.saveData(t,e),e;try{return JSON.parse(o)}catch(n){return console.warn(`Failed to parse data for key "${t}", using default.`,n),this.saveData(t,e),e}}removeData(t){localStorage.removeItem(t)}removeAllData(){localStorage.clear()}},Tt=class{canvas=null;ctx=null;canvasWidth=0;canvasHeight=0;canvasDefWidth=680;canvasDefHeight=600;entityManager=null;lastFrameTime=0;deltaTime=0;updateFunctions=[];resources={};assetLoader=null;loadedResources={};startFunctions=[];sceneEntities=[];currentSceneId=null;input=null;domInteracted=!1;onDOMInteractionFunctions=[];storageManager=null;constructor(t={}){this.init(t),this.start().then(()=>{requestAnimationFrame(this.update.bind(this))})}init(t){if(this.canvas=t.canvas??null,!this.canvas){const o=document.createElement("canvas");this.canvas=o,document.body.appendChild(this.canvas)}if(this.ctx=this.canvas.getContext("2d"),!this.ctx)throw new Error("CTX NOT FOUND!");this.canvasWidth=t.canvasWidth??0,this.canvasWidth===0&&(this.canvasWidth=this.canvasDefWidth),this.canvasHeight=t.canvasHeight??0,this.canvasHeight===0&&(this.canvasHeight=this.canvasDefHeight);const e=window.devicePixelRatio||1;if(this.canvas.width=this.canvasWidth*e,this.canvas.height=this.canvasHeight*e,this.canvas.style.width=`${this.canvasWidth}px`,this.canvas.style.height=`${this.canvasHeight}px`,this.ctx.scale(e,e),this.entityManager=new it,!this.entityManager)throw new Error("ENTITY MANAGER NOT FOUND!");if(this.resources=t.resources??{},this.assetLoader=new rt(this.resources),this.input=new ft(this),!this.input)throw new Error("INPUT NOT FOUND!");if(this.storageManager=new wt,!this.storageManager)throw new Error("STORAGE MANAGAER NOT FOUND!")}async start(){try{const t=await this.assetLoader?.loadAll();this.loadedResources=t,console.log("RESOURCES LOADED! ",t),this.startFunctions.forEach(e=>e())}catch(t){console.error("FAILED TO LOAD ASSETS:",t)}}update(t){this.deltaTime=(t-this.lastFrameTime)/1e3,this.lastFrameTime=t,this.ctx?.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.waitForDOMInteraction(),Ct(this),Rt(this),vt(this),ut(this),Et(this),this.updateFunctions.forEach(e=>{e()}),this.input?.resetStates(),requestAnimationFrame(this.update.bind(this))}waitForDOMInteraction(){const t=()=>{this.domInteracted||(this.domInteracted=!0,this.onDOMInteractionFunctions.forEach(e=>e()),this.onDOMInteractionFunctions=[],console.log("DOM INTERACTION COMPLETE!"),window.removeEventListener("pointerdown",t),window.removeEventListener("keydown",t))};window.addEventListener("pointerdown",t),window.addEventListener("keydown",t)}getCanvas(){if(!this.canvas)throw new Error("CANVAS NOT FOUND!");return this.canvas}getCtx(){if(!this.ctx)throw new Error("CTX NOT FOUND");return this.ctx}getCanvasBounds(){return{x:this.canvasWidth,y:this.canvasHeight}}getEntityManager(){if(!this.entityManager)throw new Error("ENTITY MANAGER NOT FOUND!");return this.entityManager}getDeltaTime(){return this.deltaTime}getImage(t){if(!this.loadedResources?.imagesData||!this.loadedResources.imagesData[t])throw new Error("LOADED IMAGE RESOURCE "+t+" NOT FOUND!");return this.loadedResources.imagesData[t]}getAudio(t){if(!this.loadedResources.audioData||!this.loadedResources.audioData[t])throw new Error("LOADED AUDIO RESOURCE "+t+" NOT FOUND!");return this.loadedResources.audioData[t]}getJSON(t){if(!this.loadedResources.customJsonData||!(t in this.loadedResources.customJsonData))throw new Error("LOADED JSON RESOURCE "+t+" NOT FOUND!");return this.loadedResources.customJsonData[t]}getSceneByName(t,e){const o=this.getEntityManager();for(const n of this.sceneEntities)if(o.getComponent(n,S,!0).name===t)return n;if(e)throw new Error("SCENE ID NOT FOUND IN getSceneByName(). KEY: "+t);return null}getInput(){if(!this.input)throw new Error("INPUT NOT FOUND!");return this.input}getChildWithComponent(t,e,o){const n=this.getEntityManager(),s=n.getComponent(t,M,!0);for(const a of s.value)if(n.getComponent(a,e))return a;if(o)throw new Error("NO CHILD FOUND WITH THE REQUESTED COMPONENT IN getChildWithComponet(). ID: "+t+" COMPONENT:"+e.name);return null}getChildrenWithComponent(t,e){const o=this.getEntityManager(),n=o.getComponent(t,M,!0);let s=[];return n.value.forEach(a=>{o.getComponent(a,e)&&s.push(a)}),s}getRandomInt(t=0,e=1){return Math.floor(Math.random()*(e-t+1))+t}getRandomFloat(t=0,e=1){return Math.random()*(e-t)+t}getStorageManager(){if(!this.storageManager)throw new Error("STORAGE MANAGAER NOT FOUND!");return this.storageManager}addUpdateFunction(t){if(this.updateFunctions.includes(t)){console.warn("FAILED TO ADD UPDATE FN IN addUpdateFunction(), ALREADY CONTAINS FUNCTION !",t);return}this.updateFunctions.push(t)}removeUpdateFunction(t){const e=this.updateFunctions.indexOf(t);e>-1&&this.updateFunctions.splice(e,1)}addStartFunction(t){if(this.startFunctions.includes(t)){console.warn("FAILED TO ADD START FN IN addStartFunction(), ALREADY CONTAINS FUNCTION !",t);return}this.startFunctions.push(t)}removeStartFunction(t){const e=this.startFunctions.indexOf(t);e>-1&&this.startFunctions.splice(e,1)}isEntityActive(t){const e=this.getEntityManager();let o=t;for(;o!==null;){const n=e.getComponent(o,W,!0),s=e.getComponent(o,G)??null;if(this.entityManager?.getComponent(o,S)||!s||s.value===null)return n.value;if(n.value!==!0)return!1;o=s.value}return!0}addScene(t){if(!this.getEntityManager().hasComponent(t,S))throw new Error("ENTITY DOES NOT HAS A SCENE COMPONENT IN addScene() YET YOU ARE TRYING TO ADD IT !");if(this.sceneEntities.includes(t)){console.warn("THE SCENE YOU ARE TRYING TO ADD IS ALREADY ADDED! "+t);return}this.sceneEntities.push(t)}loadScene(t){const e=this.getEntityManager(),o=e.getComponent(t,S,!0);for(const s of this.sceneEntities){const a=e.getComponent(s,W,!0);a.value=!1}this.currentSceneId!==null&&this.entityManager?.getComponent(this.currentSceneId,S)?.onUnload(),this.currentSceneId=t;const n=e.getComponent(this.currentSceneId,W,!0);n.value=!0,o.onLoad()}addParent(t,e){const o=this.getEntityManager();if(o.hasComponent(t,S))throw new Error("CANT ASSIGN PARENT TO A SCENE! "+t);const n=o.getComponent(t,G,!0),s=o.getComponent(e,M,!0);if(s.value.includes(t)){console.warn("ENTITY ALREADY HAS THIS PARENT ASSIGNED! ARE YOU ASSIGNING THE SAME PARENT AGAIN ? "+t);return}n.value=e,s.value.push(t)}playAudio(t){if(!this.domInteracted)return;t.key;const e=t.loop??!1,o=t.volume??1,s=this.getAudio(t.key).cloneNode(!1);s.loop=e,s.volume=o,s.play()}addOnDOMInteractionFunction(t){if(this.onDOMInteractionFunctions.includes(t)){console.warn("FAILED TO ADD START FN IN addStartFunction(), ALREADY CONTAINS FUNCTION !",t);return}this.onDOMInteractionFunctions.push(t)}removeEntityWithCleanup(t){const e=new X(this);e.unlinkFromParent(t),e.removeChildrenReclusively(t),this.entityManager?.removeEntity(t)}},H=class{engine;em;constructor(t){this.engine=t,this.em=t.getEntityManager()}createEmptyEntity(t){const e=this.em.createEntity();return this.em.addComponent(e,p,new p({})),this.em.addComponent(e,W,new W({})),this.em.addComponent(e,G,new G),this.em.addComponent(e,M,new M),t!==void 0&&(this.engine.addParent(e,t),console.log("CREATE ENTITY ADD PARENT CALLED!")),e}createSpriteEntity(t,e,o,n){const s=this.createEmptyEntity(n);return this.em.addComponent(s,T,new T({image:t,width:e,height:o})),s}createSceneEntity(t="unnamedScene"){const e=this.em.createEntity();return this.em.addComponent(e,p,new p({})),this.em.addComponent(e,W,new W({})),this.em.addComponent(e,S,new S({name:t})),this.em.addComponent(e,M,new M),this.engine.addScene(e),e}createRectangleEntity(t,e,o){const n=this.createEmptyEntity(o);return this.em.addComponent(n,v,new v({shape:new J({width:t,height:e})})),n}createCircleEntity(t,e){const o=this.createEmptyEntity(e);return this.em.addComponent(o,v,new v({shape:new k({radius:t})})),o}createTriangleEntity(t,e,o,n){const s=this.createEmptyEntity(n);return this.em.addComponent(s,v,new v({shape:new B({p1:t,p2:e,p3:o})})),s}createTextEntity(t,e){const o=this.createEmptyEntity(e);return this.em.addComponent(o,I,new I({content:t})),o}createRectButtonEntity(t,e,o,n){const s=this.createEmptyEntity(n);this.em.addComponent(s,F,new F({pressArea:{x:t,y:e}})),this.em.addComponent(s,v,new v({shape:new J({width:t,height:e}),blocksInput:!1}));const a=this.createTextEntity(o??"Text",s);return this.em.addComponent(a,N,new N({alignmentHorizontal:"center",alignmentVertical:"middle"})),s}createTexturedButtonEntity(t,e,o,n){const s=this.createEmptyEntity(n);return this.em.addComponent(s,F,new F({pressArea:{x:e,y:o}})),this.em.addComponent(s,T,new T({image:t,width:e,height:o,blocksInput:!1})),s}createParticleContainerEntity(t){const e=this.createEmptyEntity();return this.em.addComponent(e,z,new z(t)),{id:e,instance:()=>{const n=this.em.getComponent(e,p,!0),s=this.em.getComponent(e,z,!0),a=n.globalPosition.position,i=s.img;for(let c=0;c<s.maxNumber;c++){const r={x:this.engine.getRandomFloat(s.minScaleRange.x,s.maxScaleRange.x),y:this.engine.getRandomFloat(s.minScaleRange.y,s.maxScaleRange.y)},l=this.engine.getRandomFloat(s.minSpeedRange,s.maxSpeedRange),h=this.engine.getRandomFloat(s.minLifeTimeRange,s.maxLifeTimeRange),u=this.engine.getRandomFloat(s.minAlphaRange,s.maxAlphaRange),g=this.engine.getRandomFloat(s.minRotationRange,s.maxRotationRange),m=Math.random()*Math.PI*2,d={x:Math.cos(m)*l,y:Math.sin(m)*l},x=this.createSpriteEntity(i,i.width,i.height,e);this.em.addComponent(x,_,new _({lifeTime:h,velocity:d,alphaReductionRate:s.alphaReductionRate}));const E=this.em.getComponent(x,p,!0),R=this.em.getComponent(x,T,!0);E.scale.value=r,E.globalPosition.position={x:a.x,y:a.y},R.alpha=u,R.rotation=g}}}}};class A{targetPos={x:0,y:0};reachedTarget=!1;targetId=null;minSpeed;maxSpeed;speed;constructor(e={}){this.minSpeed=e.minSpeed??50,this.maxSpeed=e.maxSpeed??100,this.speed=this.maxSpeed}}class q{value;constructor(e={}){this.value=e.value??15}}class Y{enabled;shapeId;shapeColor;constructor(e={}){this.enabled=e.enabled??!0,this.shapeId=e.shapeId??null,this.shapeColor=e.shapeColor??"red"}}class C{value;constructor(e){this.value=e.value??"None"}}class K{}class Q{}class Z{}class L{maxValue;value;constructor(e){this.maxValue=e.maxValue??1,this.value=this.maxValue}}function It(t){const e=t.getEntityManager(),o=new H(t);e.query("All",{lineOfSight:q,debugLineOfSight:Y,transform:p},(n,{lineOfSight:s,debugLineOfSight:a,transform:i})=>{if(!t.isEntityActive(n))return;if(a.shapeId===null){const r=o.createCircleEntity(s.value),l=e.getComponent(r,v,!0);l.layer=-1,l.color=a.shapeColor,l.alpha=.1,a.shapeId=r}const c=e.getComponent(a.shapeId,p,!0);c.globalPosition.position=i.globalPosition.position})}function At(t){const e=t.getEntityManager(),o=t.getDeltaTime();e.query("All",{moveable:A,transform:p},(n,{moveable:s,transform:a})=>{const i=a.globalPosition.position,c=s.targetPos,r={x:c.x-i.x,y:c.y-i.y},l=Math.hypot(r.x,r.y);if(l>3){s.reachedTarget=!1;const u={x:r.x/l,y:r.y/l};u.x>0?a.scale.value.x=1:a.scale.value.x=-1,i.x+=u.x*s.speed*o,i.y+=u.y*s.speed*o}else s.reachedTarget=!0})}function St(t){const e=t.getEntityManager(),o=t.getCanvasBounds(),n=e.getAllEntities();e.query("All",{transform:p,moveable:A,lineOfSight:q,tag:C},(s,{transform:a,moveable:i,lineOfSight:c,tag:r})=>{const l=a.globalPosition.position,h=c.value;let u=[],g=[];for(const m of n){if(m===s)continue;const d=e.getComponent(m,C),x=e.getComponent(m,p);if(!d||!x)continue;const E=x.globalPosition.position;Math.hypot(E.x-l.x,E.y-l.y)>h||(r.value==="Rabbit"&&(d.value==="Fox"?g.push(E):d.value==="Carrot"&&u.push({id:m,pos:E})),r.value==="Fox"&&d.value==="Rabbit"&&u.push({id:m,pos:E}))}if(r.value==="Rabbit"&&g.length>0){let m=0,d=0;for(const w of g)m+=w.x,d+=w.y;m/=g.length,d/=g.length;const x={x:l.x-m,y:l.y-d},E=Math.hypot(x.x,x.y);E>0&&(x.x/=E,x.y/=E);const R=100;let O=l.x+x.x*R,b=l.y+x.y*R;O=Math.max(0,Math.min(o.x,O)),b=Math.max(0,Math.min(o.y,b));const f=10;if((O<=f||O>=o.x-f)&&(b<=f||b>=o.y-f)){const w=t.getRandomFloat(0,Math.PI*2),P=Math.cos(w),U=Math.sin(w);O=Math.max(f,Math.min(o.x-f,l.x+P*R)),b=Math.max(f,Math.min(o.y-f,l.y+U*R))}i.targetPos={x:O,y:b};return}if(u.length>0){let m=u[0],d=Math.hypot(m.pos.x-l.x,m.pos.y-l.y);for(const x of u){const E=Math.hypot(x.pos.x-l.x,x.pos.y-l.y);E<d&&(m=x,d=E)}i.targetPos=m.pos,i.targetId=m.id;return}i.reachedTarget&&(i.targetPos={x:t.getRandomFloat(0,o.x),y:t.getRandomFloat(0,o.y)}),i.targetId=null})}function Pt(t){const e=t.getEntityManager(),o=t.getCtx();e.query("All",{movable:A,transform:p},(n,{movable:s,transform:a})=>{const i=a.globalPosition.position,c=s.targetPos;o.save(),o.beginPath(),o.strokeStyle="red",o.moveTo(i.x,i.y),o.lineTo(c.x,c.y),o.stroke(),o.closePath(),o.restore()})}function Nt(t){const e=t.getEntityManager(),o=new H(t),n=t.getSceneByName("simulation",!0),s=()=>{const c=o.createTextEntity("Carrots: ",n);e.addComponent(c,N,new N({alignmentHorizontal:"left",alignmentVertical:"top",offset:{x:0,y:10}})),e.addComponent(c,K,new K);const r=e.getComponent(c,I,!0);r.size=20,r.layer=1},a=()=>{const c=o.createTextEntity("Rabbits: ",n);e.addComponent(c,N,new N({alignmentHorizontal:"left",alignmentVertical:"top",offset:{x:0,y:50}})),e.addComponent(c,Q,new Q);const r=e.getComponent(c,I,!0);r.size=20,r.layer=1},i=()=>{const c=o.createTextEntity("Foxes: ",n);e.addComponent(c,N,new N({alignmentHorizontal:"left",alignmentVertical:"top",offset:{x:0,y:90}})),e.addComponent(c,Z,new Z);const r=e.getComponent(c,I,!0);r.size=20,r.layer=1};s(),a(),i()}function Mt(t){const e=t.getEntityManager();let o=0;e.query("All",{tag:C},(n,{tag:s})=>{t.isEntityActive(n)&&s.value==="Carrot"&&o++}),e.query("All",{carrotCountText:K,text:I},(n,{carrotCountText:s,text:a})=>{a.content=`Carrots: ${o}`})}function Ot(t){const e=t.getEntityManager();let o=0;e.query("All",{tag:C},(n,{tag:s})=>{t.isEntityActive(n)&&s.value==="Rabbit"&&o++}),e.query("All",{rabbitCountText:Q,text:I},(n,{rabbitCountText:s,text:a})=>{a.content=`Rabbits: ${o}`})}function bt(t){const e=t.getEntityManager();let o=0;e.query("All",{tag:C},(n,{tag:s})=>{t.isEntityActive(n)&&s.value==="Fox"&&o++}),e.query("All",{foxCountText:Z,text:I},(n,{foxCountText:s,text:a})=>{a.content=`Foxes: ${o}`})}function Dt(t){const e=t.getJSON("simulationData"),o=t.getEntityManager(),n=new H(t);o.query("All",{moveable:A,tag:C},(s,{moveable:a,tag:i})=>{if(t.isEntityActive(s)&&a.reachedTarget&&a.targetId&&o.hasEntity(a.targetId)){const c=o.getComponent(s,L,!0);c.value+=e.energyGainUponEating;const r=o.getComponent(a.targetId,C,!0),l=o.getComponent(a.targetId,p,!0);let h=t.getImage("orangePixel");r.value==="Carrot"?(console.log("CARROT GOT EATEN"),h=t.getImage("orangePixel")):r.value==="Rabbit"&&(h=t.getImage("pinkPixel"),console.log("RABBIT GOT EATEN"));const{id:u,instance:g}=n.createParticleContainerEntity({img:h,minScaleRange:{x:8,y:8},maxScaleRange:{x:10,y:10},minLifeTimeRange:.4,maxLifeTimeRange:.55}),m=o.getComponent(u,p,!0);m.globalPosition.position=l.globalPosition.position,g();const d=o.getComponent(a.targetId,Y);d&&(d.shapeId&&t.removeEntityWithCleanup(d.shapeId),d.shapeId=null),t.removeEntityWithCleanup(a.targetId),a.targetId=null}})}function Ft(t){t.getEntityManager().query("All",{moveable:A,energy:L},(o,{moveable:n,energy:s})=>{const a=Math.max(0,Math.min(1,s.value/s.maxValue));n.speed=n.minSpeed+(n.maxSpeed-n.minSpeed)*a})}function Lt(t){const e=t.getJSON("simulationData"),o=t.getEntityManager(),n=new H(t),s=t.getDeltaTime();o.query("All",{transform:p,energy:L},(a,{transform:i,energy:c})=>{if(c.value-=e.energyDepletionRate*s,c.value<=0){const r=t.getImage("darkPixel"),{id:l,instance:h}=n.createParticleContainerEntity({img:r,minScaleRange:{x:8,y:8},maxScaleRange:{x:10,y:10},minLifeTimeRange:.4,maxLifeTimeRange:.55}),u=o.getComponent(l,p,!0);u.globalPosition.position=i.globalPosition.position,h();const g=o.getComponent(a,Y);g&&(g.shapeId&&t.removeEntityWithCleanup(g.shapeId),g.shapeId=null),t.removeEntityWithCleanup(a)}})}class et{options;constructor(e){this.options=e}init(){const e=this.options.engine,o=e.getEntityManager(),n=new H(e),s=e.getImage("rabbit"),a=n.createSpriteEntity(s,16,16,this.options.parentId);o.addComponent(a,A,new A),o.addComponent(a,q,new q({value:100})),o.addComponent(a,Y,new Y({shapeColor:"rgb(174, 255, 140)"})),o.addComponent(a,C,new C({value:"Rabbit"})),o.addComponent(a,L,new L({maxValue:1}));const i=o.getComponent(a,p,!0),c=o.getComponent(a,A,!0);return i.globalPosition.position=this.options.pos??{x:0,y:0},c.targetPos=i.globalPosition.position,a}}class nt{options;constructor(e){this.options=e}init(){const e=this.options.engine,o=e.getEntityManager(),n=new H(e),s=e.getImage("fox"),a=n.createSpriteEntity(s,16,16,this.options.parentId);o.addComponent(a,A,new A),o.addComponent(a,q,new q({value:100})),o.addComponent(a,Y,new Y({shapeColor:"rgb(177, 16, 16)"})),o.addComponent(a,C,new C({value:"Fox"})),o.addComponent(a,L,new L({maxValue:1}));const i=o.getComponent(a,p,!0),c=o.getComponent(a,A,!0);return i.globalPosition.position=this.options.pos??{x:0,y:0},c.targetPos=i.globalPosition.position,a}}function Ht(t){t.getJSON("simulationData");const e=t.getEntityManager(),o=new H(t);e.query("All",{transform:p,tag:C,energy:L},(n,{transform:s,tag:a,energy:i})=>{if(i.value>=i.maxValue*2){const c=t.getSceneByName("simulation",!0),r={x:t.getRandomFloat(-5,5),y:t.getRandomFloat(-5,5)};i.value-=i.maxValue;const l=s.globalPosition.position,h=t.getImage("heart"),{id:u,instance:g}=o.createParticleContainerEntity({img:h,minScaleRange:{x:1,y:1},maxScaleRange:{x:1.5,y:1.5},minLifeTimeRange:.55,maxLifeTimeRange:.65,maxNumber:4}),m=e.getComponent(u,p,!0);m.globalPosition.position=l,g(),a.value==="Rabbit"?new et({engine:t,pos:{x:l.x+r.x,y:l.y+r.y},parentId:c}).init():a.value==="Fox"&&new nt({engine:t,pos:{x:l.x+r.x,y:l.y+r.y},parentId:c}).init()}})}const y=new Tt({resources:{images_JSON_path:"data/imagesData.json",jsons:{simulationData:"data/simulationData.json"}}}),tt=y.getEntityManager(),ot=new H(y);let $;y.addStartFunction(Ut.bind(void 0));y.addUpdateFunction(Wt.bind(void 0));function Ut(){$=y.getJSON("simulationData");const t=ot.createSceneEntity("simulation");y.loadScene(t),Nt(y),Jt({max:16,parentId:t}),$t({max:4,parentId:t})}function Wt(){const t=y.getDeltaTime();Yt(t),Lt(y),It(y),Ht(y),St(y),Pt(y),Ft(y),At(y),Dt(y),Mt(y),Ot(y),bt(y)}function Jt(t){const e=y.getCanvasBounds();for(let o=0;o<t.max;o++){const n={x:y.getRandomFloat(0,e.x),y:y.getRandomFloat(0,e.y)};new et({engine:y,pos:{x:n.x,y:n.y},parentId:t.parentId}).init()}}function Yt(t){const e=$.foodSpawnDelay,o=$.minFoodSpawns,n=$.maxFoodSpawns;let s=$.foodSpawnCounter;if(s-=t,s<=0){const a=y.getCanvasBounds(),i=y.getRandomInt(o,n),c=y.getImage("carrot");for(let r=0;r<i;r++){const l={x:y.getRandomFloat(0,a.x),y:y.getRandomFloat(0,a.y)},h=ot.createSpriteEntity(c,16,16);tt.addComponent(h,C,new C({value:"Carrot"}));const u=tt.getComponent(h,p,!0);u.globalPosition.position=l}s=e}$.foodSpawnCounter=s}function $t(t){const e=y.getCanvasBounds();for(let o=0;o<t.max;o++){const n={x:y.getRandomFloat(0,e.x),y:y.getRandomFloat(0,e.y)};new nt({engine:y,pos:{x:n.x,y:n.y},parentId:t.parentId}).init()}}
